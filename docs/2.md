# 2. MODELLING AND FORECASTING

## 2.1 Aquifers
  
## 2.2 Water Springs

### 2.2.1 Madonna di Canneto

#### Choosing the best model

After performing autoML on all datasets of Madonna di Canneto (original and featured), **GBM** resulted to be the best regression model. This coincided with a check we did on RapidMiner.

  ![varimp h2o jpg](https://user-images.githubusercontent.com/43357858/108821918-9d67e580-75be-11eb-82ec-276d1e28cbe2.png)

Instead, after performing autoTS we found tbats to be the best performance as timeseries model.

```
# Comparison of TS model errors (RMSE)
  prophet   ets sarima tbats  bats  stlm shortterm bagged
    <dbl> <dbl>  <dbl> <dbl> <dbl> <dbl>     <dbl>  <dbl>
1    32.9  2.58   7.64  1.27  2.54  6.08      2.76   3.59
```

![autoTS_res jpg](https://user-images.githubusercontent.com/43357858/108823840-431c5400-75c1-11eb-99e0-e8cb8dd83e10.png)

We also plotted predicted vs actual values for tbats.

![tbats](https://user-images.githubusercontent.com/43357858/108824227-c76ed700-75c1-11eb-90ab-e921b2c10269.jpg)

#### Model results 

##### Gradient Boost Machine 

GBM model resulted in an RMSE of 26.05 L/s. 

The following graph shows the relationship between predicted and actual target values. 

![gbm_act_pred](https://user-images.githubusercontent.com/43357858/108827719-3b12e300-75c6-11eb-9acb-d78da5a5fdca.jpg)

The model showed that temperature has the greatest influence over flow rate, followed by the 8-day time lag of rainfall. 

![rel_infl gbm](https://user-images.githubusercontent.com/43357858/108828497-37339080-75c7-11eb-8872-ee9b9101533b.jpg).

## 2.3 River

## 2.4 Lake